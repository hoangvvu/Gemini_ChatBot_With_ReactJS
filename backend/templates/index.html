<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Chatbot AI</title>
    <style>
        body { background-color: #121212; color: white; font-family: Arial; text-align: center; }
        #chatbox { width: 60%; margin: 20px auto; border: 1px solid #444; border-radius: 10px; padding: 10px; background: #1e1e1e; }
        #messages { height: 400px; overflow-y: auto; text-align: left; }
        .user, .bot { margin-bottom: 10px; }
        .user { color: #7dd3fc; }
        .bot { color: #a3e635; }
        img { max-width: 200px; border-radius: 10px; margin: 5px 0; }
        input[type="text"] { width: 70%; padding: 10px; border: none; border-radius: 5px; }
        input[type="file"] { margin-left: 10px; }
        button { padding: 10px 15px; background: #10b981; border: none; border-radius: 5px; color: white; cursor: pointer; }
        button:hover { background: #059669; }
    </style>
</head>
<body>
    <h2>Chatbot AI</h2>
    <div id="chatbox">
        <div id="messages"></div>
        <form id="chatForm" enctype="multipart/form-data">
            <input type="text" id="userInput" name="message" placeholder="Nháº­p tin nháº¯n..." />
            <input type="file" id="imageInput" name="image" accept="image/*" />
            <button type="submit">Gá»­i</button>
        </form>
    </div>

    <script>
        document.getElementById("chatForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const message = document.getElementById("userInput").value.trim();
            const imageFile = document.getElementById("imageInput").files[0];

            if (!message && !imageFile) return;

            appendMessage("user", message || "[Ä‘Ã£ gá»­i áº£nh]");

            const formData = new FormData();
            formData.append("message", message);
            if (imageFile) formData.append("image", imageFile);

            const res = await fetch("/chat", {
                method: "POST",
                body: formData
            });

            const data = await res.json();
            appendMessage("bot", data.reply);

            if (data.image_url) {
                const img = document.createElement("img");
                img.src = data.image_url;
                document.getElementById("messages").appendChild(img);
            }

            document.getElementById("userInput").value = "";
            document.getElementById("imageInput").value = "";
        });

        function appendMessage(sender, text) {
            const div = document.createElement("div");
            div.className = sender;
            div.textContent = (sender === "user" ? "ðŸ‘¤ Báº¡n: " : "ðŸ¤– Bot: ") + text;
            document.getElementById("messages").appendChild(div);
            document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight;
        }
    </script>
</body>
</html>
